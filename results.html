<head>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:400,700" rel="stylesheet">
<link href='/6foundations/style.css' rel='stylesheet' type='text/css'>
<title>6Foundations</title>
<link rel="icon" type="x-icon" href="icon.png">
<link rel="shortcut icon" type="x-icon" href="icon.png">
<meta charset="utf-8">
</head>

<script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.0/dist/chart.js"></script>

<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="application/javascript" src="/6foundations/ideologies.js">
</script>
<h1>6Foundations</h1>
<hr>
<h1 id="test">Results</h1>
<br>
	
<div id="capture" class="capture">
<br>
<div class="element">
<div style="text-align: right;"><h2 style="font-size: 30px; display: inline">6Foundations</h2><h2 style="font-size: 30px; display: inline; font-weight: 300"> (PoliticalTests)</h2></div>
<h2>Care: <span class="weight-300" id="care-label"></span></h2>
<div class="axis">
    <img id="img-care" src="/6foundations/value_images/care.png" height="128pt"/>
    <div class="bar care" id="bar-care"><div class="text-wrapper" id="care"></div></div>
    <div class="bar nocare" id="bar-nocare"><div class="text-wrapper" id="nocare"></div></div>
</div>

<h2>Fairness: <span class="weight-300" id="fairness-label"></span></h2>
<div class="axis">
    <img id="img-fairness" src="/6foundations/value_images/fairness.png" height="128pt"/>
    <div class="bar fairness" id="bar-fairness"><div class="text-wrapper" id="fairness"></div></div>
    <div class="bar nofair" id="bar-nofair"><div class="text-wrapper" id="nofair"></div></div>
</div>

<h2>Loyalty: <span class="weight-300" id="loyalty-label"></span></h2>
<div class="axis">
    <img id="img-loyalty" src="/6foundations/value_images/loyalty.png" height="128pt"/>
    <div class="bar loyalty" id="bar-loyalty"><div class="text-wrapper" id="loyalty"></div></div>
    <div class="bar noloyal" id="bar-noloyal"><div class="text-wrapper" id="noloyal"></div></div>
</div>

<h2>Authority: <span class="weight-300" id="authority-label"></span></h2>
<div class="axis">
    <img id="img-authority" src="/6foundations/value_images/authority.png" height="128pt"/>
    <div class="bar authority" id="bar-authority"><div class="text-wrapper" id="authority"></div></div>
    <div class="bar noauth" id="bar-noauth"><div class="text-wrapper" id="noauth"></div></div>
</div>

<h2>Sanctity: <span class="weight-300" id="sanctity-label"></span></h2>
<div class="axis">
    <img id="img-sanctity" src="/6foundations/value_images/sanctity.png" height="128pt"/>
    <div class="bar sanctity" id="bar-sanctity"><div class="text-wrapper" id="sanctity"></div></div>
    <div class="bar nosanc" id="bar-nosanc"><div class="text-wrapper" id="nosanc"></div></div>
</div>


<h2>Liberty: <span class="weight-300" id="liberty-label"></span></h2>
<div class="axis">
    <img id="img-liberty" src="/6foundations/value_images/liberty.png" height="128pt"/>
    <div class="bar liberty" id="bar-liberty"><div class="text-wrapper" id="liberty"></div></div>
    <div class="bar nolib" id="bar-nolib"><div class="text-wrapper" id="nolib"></div></div>
</div>
	
</div><br>

<div class="element"> 
  <h2>Estimated Ideology: <span class="weight-300" id="ideology-label" onclick="ideologyLink()" style="color: #2222DD;text-decoration: underline;cursor: pointer"></span></h2> 
  <p class="ideodesc"><span class="weight-300" id="ideodesc-label"></span></p><br>
  <p class="ideonext"><b>Next Matches:</b> <span class="weight-300" id="ideonext-label"></span></p>
</div>
<br>

<div class="element" id="ChartDiv">
<div class="donutDiv"><canvas id="donutChart"></canvas><br></div>
<div class="radarDiv"><canvas id="radarChart"></canvas><br></div>
</div> <br>
</div>

<div class="element" style="overflow:hidden">	
<h2>Correlation:</h2> <br>
<p><b>Use this section to calculate how much your political beliefs align with your moral views.</b></p><br>
<p>Insert your <a href="https://8values.github.io/">8values</a> scores here to calculate the correlation between your moral values and your political values.</p>
<p>If you wish to insert your <a href="https://sapplyvalues.github.io/">SapplyValues</a> scores instead, insert your scores, and then click on the "Convert" button. Ignore the second text box.</p><br>

<input id="econinput" placeholder="Economic / Left-Right Axis">
<input id="diplinput" placeholder="Diplomatic Axis">
<input id="civilinput" placeholder="Civil / Auth-Lib Axis">
<input id="sctyinput" placeholder="Societal / Prog-Con Axis">
	
<br><br>
<button class="small_button" style="float: left; font-size: 14px;" onclick="convertScores()" id="convertBtn">Convert</button>
<br><br>
</div>
	
<br>
<div class="element">	
<h2>What does the "Estimated Ideology" mean?</h2>
<p>In addition to matching you to the six moral foundations, the quiz also attempts to match you to a political ideology. 
This is much less accurate than the values and axes since it is just an estimation based on correlations between people's moral and political beliefs, so don't take it too seriously. 
This is called an estimate because the connection between the moral values and the political ideologies are correlated, but not directly linked.</p><br>
	
<h2>I don't like my scores!</h2>
<p>Think your scores were wrong? Want to help us calibrate the test? Send us any comments, questions, or criticism in the <a href="https://github.com/politicaltests/politicaltests.github.io/issues">Github</a>. </p>
<p>You can send these results by copying and pasting the URL with the button below, or by copying the canvas image in the bottom of the page. </p>
</div>
	
<br>

<button class="button clipboard" onclick="screenshotText()" style="font-size:18pt;" id="copybutton" data-i18n="copy-url">Copy Results URL</button><br>
<button class="button" onclick="location.href='https://politicaltests.github.io/6foundations/';" style="background-color: #2196f3;">Back</button> <br>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

<script>
	
    window.onload = function doCapture() {
  	html2canvas(document.getElementById('capture'), {
    	onrendered: function(canvas) { document.body.appendChild(canvas); },
  	});
     }
	
    var $temp = $("<input>");
    var $url = $(location).attr('href');

    $('.clipboard').on('click', function() {
	$("body").append($temp);
	$temp.val($url).select();
	document.execCommand("copy");
	$temp.remove();
    })
   
    function screenshotText() {
	document.getElementById("copybutton").innerHTML = "URL Copied!"
    }
	  
    function getQueryVariable(variable) {
           var query = window.location.search.substring(1)
           var vars = query.split("&")
           for (var i=0;i<vars.length;i++) {
                   var pair = vars[i].split("=")
                   if(pair[0] == variable) {return pair[1]}
           }
           return(NaN);
    }

    function setBarValue(name, value) {
        innerel = document.getElementById(name)
        outerel = document.getElementById("bar-" + name)
        outerel.style.width = (value + "%")
        innerel.innerHTML = (value + "%")
        if (innerel.offsetWidth + 20 > outerel.offsetWidth) {
            innerel.style.visibility = "hidden"
        }
    }

    //Define Values
    care      = getQueryVariable("care")      
    fairness  = getQueryVariable("fairness")  
    loyalty   = getQueryVariable("loyalty")   
    authority = getQueryVariable("authority") 
    sanctity  = getQueryVariable("sanctity")  
    liberty   = getQueryVariable("liberty")   

    nocare    = (100 - care     ).toFixed(1)
    nofair     = (100 - fairness ).toFixed(1)
    noloyal     = (100 - loyalty  ).toFixed(1)
    noauth   = (100 - authority).toFixed(1)
    nosanc      = (100 - sanctity ).toFixed(1)
    nolib     = (100 - liberty  ).toFixed(1)

    setBarValue("care", care)
    setBarValue("nocare", nocare)
    setBarValue("nofair", nofair)
    setBarValue("fairness", fairness)
    setBarValue("loyalty", loyalty)
    setBarValue("noloyal", noloyal)
    setBarValue("authority", authority)
    setBarValue("noauth", noauth)
    setBarValue("sanctity", sanctity)
    setBarValue("nosanc", nosanc)
    setBarValue("liberty", liberty)
    setBarValue("nolib", nolib)

    carescore  = Math.round (100* ((getQueryVariable("care")      / 100) * 30)) / 100 
    fairscore  = Math.round (100* ((getQueryVariable("fairness")  / 100) * 30)) / 100 
    loyalscore = Math.round (100* ((getQueryVariable("loyalty")   / 100) * 30)) / 100 
    authscore  = Math.round (100* ((getQueryVariable("authority") / 100) * 30)) / 100 
    sancscore  = Math.round (100* ((getQueryVariable("sanctity")  / 100) * 30)) / 100 
    libscore   = Math.round (100* ((getQueryVariable("liberty")   / 100) * 30)) / 100 
	  
    document.getElementById("care-label").innerHTML      = carescore  + " / 30"
    document.getElementById("fairness-label").innerHTML  = fairscore  + " / 30"
    document.getElementById("loyalty-label").innerHTML   = loyalscore + " / 30"
    document.getElementById("authority-label").innerHTML = authscore  + " / 30"
    document.getElementById("sanctity-label").innerHTML  = sancscore  + " / 30"
    document.getElementById("liberty-label").innerHTML   = libscore   + " / 30"
	
    careprop  = care  - 10
    fairprop  = fairness  - 10
    loyalprop = loyalty - 10
    authprop  = authority  - 10
    sancprop  = sanctity  - 10
    libprop   = liberty   - 10
	
    carepercent  = Math.round ((careprop  / (careprop + fairprop + loyalprop + authprop + sancprop + libprop)) * 100)
    fairpercent  = Math.round ((fairprop  / (careprop + fairprop + loyalprop + authprop + sancprop + libprop)) * 100)
    loyalpercent = Math.round ((loyalprop / (careprop + fairprop + loyalprop + authprop + sancprop + libprop)) * 100)
    authpercent  = Math.round ((authprop  / (careprop + fairprop + loyalprop + authprop + sancprop + libprop)) * 100)
    sancpercent  = Math.round ((sancprop  / (careprop + fairprop + loyalprop + authprop + sancprop + libprop)) * 100)
    libpercent   = Math.round ((libprop   / (careprop + fairprop + loyalprop + authprop + sancprop + libprop)) * 100)

    //Ideologies      
    ideology = ""
    ideolink = ""
    ideodesc = ""
    nextmatch = ""
    ideodist = Infinity
    for (var i = 0; i < ideologies.length; i++) {
        dist = 0
        dist += Math.pow((Math.abs(20 + ((ideologies[i].stats.care      - care      / 100) * 80))), 1.0)
        dist += Math.pow((Math.abs(20 + ((ideologies[i].stats.fairness  - fairness  / 100) * 80))), 1.0)
        dist += Math.pow((Math.abs(20 + ((ideologies[i].stats.loyalty   - loyalty   / 100) * 80))), 1.0)
        dist += Math.pow((Math.abs(20 + ((ideologies[i].stats.authority - authority / 100) * 80))), 1.0)
        dist += Math.pow((Math.abs(20 + ((ideologies[i].stats.sanctity  - sanctity  / 100) * 80))), 1.0)
        dist += Math.pow((Math.abs(20 + ((ideologies[i].stats.liberty   - liberty   / 100) * 80))), 1.0) 
	    
        if (dist < ideodist) {
            ideology = ideologies[i].name
	    ideolink = ideologies[i].link
            ideodesc = ideologies[i].desc
	    ideonext = ideologies[i].next
            ideodist = dist
        }
    }

    document.getElementById("ideology-label").innerHTML = ideology
    document.getElementById("ideodesc-label").innerHTML = ideodesc
    document.getElementById("ideonext-label").innerHTML = ideonext

    function ideologyLink() {
  	window.open(ideolink);
    }
	
    //Correlation
    function convertScores() {
	document.getElementById("econinput").value = document.getElementById("econinput").value * 10
	document.getElementById("diplinput").value = document.getElementById("diplinput").value * 10
	document.getElementById("civilinput").value = document.getElementById("civilinput").value * 10
	document.getElementById("sctyinput").value = document.getElementById("sctyinput").value * 10
 	document.getElementById("convertBtn").innerHTML = "Convert ✔" 
    }
	    
    //Donut
	Chart.register(ChartDataLabels);
	
	const data = {
	    labels: ["Care", "Fairness", "Loyalty", "Authority", "Sanctity", "Liberty"],
	    datasets: [{
	      label: 'Dataset',
	      backgroundColor: [
	  	"rgba(224,102,102,0.5)",
	  	"rgba(106,168,79,0.5)",
	  	"rgba(142,124,195,0.5)",
	  	"rgba(28,69,135,0.5)",
	  	"rgba(222,138,82,0.5)",
	  	"rgba(241,194,50,0.5)"
	      ],
	      borderColor: ["#b03a2e", "#1e8449", "#6c3483", "#1f618d", "#af601a", "#b7950b"],
	      data: [carepercent, fairpercent, loyalpercent, authpercent, sancpercent, libpercent],
	      BorderWidth: 2,
	      offset: 4.5,
	      hoverBorderOffset: 10,
	    }]
	  };
	
	var ctx = document.getElementById("donutChart");
	ctx.width  = 550;
	ctx.height = 600;
	
	var donutChart = new Chart(ctx, {
	  type: 'doughnut',
	  data: data,
		
	  options: {
	    responsive: true,
	    maintainAspectRatio: true,
	    position: "bottom",
	    showAllTooltips: true, 
	    animation: false,
		
	    plugins: {
		title: {
		    display: true,
		    position: "top",
		    text: "Comparison between your moral values:",
		    font:{ size: 24, weight: 'bold' }
		}, 
		legend: { 
		    labels:{ font:{ size:15, weight: 'bold' }}
		},
		tooltip: {
		    enabled: false
		},
		datalabels: {
		    color: ["#b03a2e", "#1e8449", "#6c3483", "#1f618d", "#af601a", "#b7950b"],
		    font:{ size: 30, family: '"Montserrat", sans-serif', weight: 'bold'},
		    formatter: (value, ctx) => { let datasets = ctx.chart.data.datasets;
         		if (datasets.indexOf(ctx.dataset) === datasets.length - 1) { let sum = datasets[0].data.reduce((a, b) => a + b, 0);
           		let percentage = Math.round((value / sum) * 100) + '%'; return percentage; } else { return percentage; }},
		}
	    }
	  }
	});

	
	//Radar
	const data2 = {
	    labels: ["Care", "Fairness", "Loyalty", "Authority", "Sanctity", "Liberty"],
	    datasets: [{
	      label: 'YOUR SCORE',
	      backgroundColor: "rgba(38, 50, 56, 0.4)",
	      borderColor: "rgba(38, 50, 56, 1)",
	      data: [carescore, fairscore, loyalscore, authscore, sancscore, libscore]
	    }, {
	      label: 'Progressivism',
	      backgroundColor: "rgba(56, 142, 60, 0.4)",
	      borderColor: "rgba(56, 142, 60 , 0.7)",
	      data: [22.8, 22, 13.5, 15.3, 7.5, 15]
	    }, {
	      label: 'Conservatism',
	      backgroundColor: "rgba(21, 101, 192, 0.4)",
	      borderColor: "rgba(21, 101, 192, 0.7)",
	      data: [18, 17.5, 19.5, 19.5, 18, 22.5]
	    }, {
	      label: 'Libertarianism',
	      backgroundColor: "rgba(253, 216, 53, 0.4)",
	      borderColor: "rgba(253, 216, 53, 0.7)",
	      data: [16, 18, 12.6, 12, 9, 26]
	    }, {
	      label: 'Marxism–Leninism',
	      backgroundColor: "rgba(146, 43, 33, 0.4)",
	      borderColor: "rgba(146, 43, 33, 0.7)",
	      data: [13, 25, 16, 20, 10.5, 13]
	    }]
	  };
	
	var ctx = document.getElementById("radarChart");
	ctx.width  = 550;
	ctx.height = 600;
	
	var radarChart = new Chart(ctx, {
	  type: 'line',
	  data: data2,
		
	  options: {
	    responsive: true,
	    maintainAspectRatio: true,
	    indexAxis: 'x',
	    animation: false,
	    scales: { y: { beginAtZero: true }},
		  
	    elements: { 
		point: { 
		    radius: 5, 
		    hoverRadius: 10, 
		    borderJoinStyle: 'round' 
		},
		line: {
	      	    fill: false,
		}
	    },
		  
	    plugins: {
		title: {
		    display: true,
		    position: "top",
		    text: "Comparison with major political groups:",
		    font:{ size: 24, weight: 'bold' }
		},
		subtitle: {
		    display: true,
		    position: "bottom",
		    text: "Click on the legend to hide specific lines.",
		    padding: 5,
		    font:{ size: 14 }
		},
		legend: { 
		    labels: { font: { size:15, weight: 'bold' }},
		},
	        datalabels: { display: false }
	    }
	  }
	});
	
	
    </script>


</body>
